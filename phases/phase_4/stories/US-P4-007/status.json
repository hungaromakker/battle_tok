{
    "story_id": "US-P4-007",
    "title": "Linear Extrude + Lathe Revolution",
    "status": "pending",
    "focus": "",
    "complexity": "complex",
    "min_iterations": 2,
    "criteria": [
        {"text": "ExtrudeMode enum exists with Pump, Linear, and Lathe variants", "done": false, "notes": ""},
        {"text": "Linear extrusion creates proper prismatic meshes along Z-axis", "done": false, "notes": ""},
        {"text": "Taper parameter scales the outline from base to tip", "done": false, "notes": ""},
        {"text": "Top and bottom caps are properly triangulated for closed outlines", "done": false, "notes": ""},
        {"text": "Lathe revolution creates rotationally symmetric meshes around Y-axis", "done": false, "notes": ""},
        {"text": "Partial revolution (< 360 degrees) works with proper end caps", "done": false, "notes": ""},
        {"text": "Mode switching (P/L/R or Tab) works in Stage 2", "done": false, "notes": ""},
        {"text": "Each mode's specific sliders appear in the property panel", "done": false, "notes": ""},
        {"text": "Normals are correct for all mesh types (proper lighting)", "done": false, "notes": ""},
        {"text": "Existing pump/inflate mode still works correctly", "done": false, "notes": ""},
        {"text": "battle_arena.rs is NOT modified", "done": false, "notes": ""},
        {"text": "cargo check passes for all binaries", "done": false, "notes": ""}
    ],
    "verification_commands": [
        {"cmd": "grep -c 'ExtrudeMode\\|Linear\\|Lathe' /home/hungaromakker/battle_tok/src/game/asset_editor/extrude.rs", "expect_gt": 0, "description": "ExtrudeMode enum with Linear and Lathe variants"},
        {"cmd": "grep -c 'linear_extrude\\|lathe_revolve\\|taper\\|lathe_segments' /home/hungaromakker/battle_tok/src/game/asset_editor/extrude.rs", "expect_gt": 0, "description": "Linear and lathe extrusion functions exist"},
        {"cmd": "grep -c 'cap_triangulate\\|connect_layers\\|revolve' /home/hungaromakker/battle_tok/src/game/asset_editor/extrude.rs", "expect_gt": 0, "description": "Cap and connection helpers exist"},
        {"cmd": "cd /home/hungaromakker/battle_tok && cargo check 2>&1; echo EXIT:$?", "expect_contains": "EXIT:0", "description": "Project compiles"}
    ],
    "checklist": [
        {"item": "Read spec.md and understand linear extrude and lathe algorithms", "done": false},
        {"item": "Add ExtrudeMode enum with Pump, Linear, Lathe variants", "done": false},
        {"item": "Add taper, extrude_height, lathe_segments, lathe_angle to ExtrudeParams", "done": false},
        {"item": "Implement linear_extrude() with layer generation and triangle strips", "done": false},
        {"item": "Implement cap_triangulate() for top/bottom face capping", "done": false},
        {"item": "Implement lathe_revolve() with Y-axis revolution and triangle strips", "done": false},
        {"item": "Implement compute_lathe_normal() for correct surface normals", "done": false},
        {"item": "Handle partial revolution (< 360 degrees) with end caps", "done": false},
        {"item": "Add mode switching to generate_preview() dispatch", "done": false},
        {"item": "Wire up P/L/R key bindings in Stage 2", "done": false},
        {"item": "Verify existing pump/inflate mode still works", "done": false},
        {"item": "Run cargo check for all binaries", "done": false},
        {"item": "Commit changes", "done": false}
    ],
    "worker_notes": "",
    "notes_history": [],
    "iteration": 0,
    "failed_reasons": [],
    "dependencies": ["US-P4-006"],
    "commit_hash": "",
    "files_modified": [],
    "iteration_history": [],
    "learnings": [],
    "verification_rejections": 0,
    "created_at": "2026-02-06T18:00:00Z"
}
